

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>memory.c &mdash; AtomVM 0.7.0-dev+git.41489911 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=e925141f" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="canonical" href="https://doc.atomvm.org/main/apidocs/libatomvm/src/memory.c.html" />
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=b4fb65af"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="memory.h" href="memory.h.html" />
    <link rel="prev" title="mailbox.h" href="mailbox.h.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/avm_logo_banner.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../welcome-to-atomvm.html">Welcome to AtomVM!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started-guide.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../atomvm-tooling.html">AtomVM Tooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../programmers-guide.html">Programmers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../network-programming-guide.html">Network Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed-erlang.html">Distributed Erlang</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../differences-with-beam.html">Differences between AtomVM and BEAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stubbed-functions.html">Stubbed Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../build-instructions.html">Build Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../atomvm-internals.html">AtomVM Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../memory-management.html">Memory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../packbeam-format.html">Packbeam Format</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../api-reference-documentation.html">API Reference Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../api-reference-documentation.html#erlang-libraries">Erlang Libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../api-reference-documentation.html#atomvm-c-apis">AtomVM ‘C’ APIs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html">libAtomVM</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#libatomvm-source-files">libAtomVM source files</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="atom.c.html">atom.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="atom.h.html">atom.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="atom_table.c.html">atom_table.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="atom_table.h.html">atom_table.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="atomvm_version.h.html">atomvm_version.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="avmpack.c.html">avmpack.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="avmpack.h.html">avmpack.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="bif.c.html">bif.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="bif.h.html">bif.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="bitstring.c.html">bitstring.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="bitstring.h.html">bitstring.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="context.c.html">context.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="context.h.html">context.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="debug.c.html">debug.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="debug.h.html">debug.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="defaultatoms.h.html">defaultatoms.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="dictionary.c.html">dictionary.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="dictionary.h.html">dictionary.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="dist_nifs.c.html">dist_nifs.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="dist_nifs.h.html">dist_nifs.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="erl_nif.h.html">erl_nif.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="erl_nif_priv.h.html">erl_nif_priv.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="ets.c.html">ets.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="ets.h.html">ets.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="ets_hashtable.c.html">ets_hashtable.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="ets_hashtable.h.html">ets_hashtable.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="exportedfunction.h.html">exportedfunction.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="externalterm.c.html">externalterm.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="externalterm.h.html">externalterm.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="globalcontext.c.html">globalcontext.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="globalcontext.h.html">globalcontext.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="iff.c.html">iff.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="iff.h.html">iff.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="inet.c.html">inet.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="inet.h.html">inet.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="interop.c.html">interop.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="interop.h.html">interop.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="intn.c.html">intn.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="intn.h.html">intn.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="jit.c.html">jit.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="jit.h.html">jit.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="jit_stream_flash.c.html">jit_stream_flash.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="jit_stream_flash.h.html">jit_stream_flash.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="list.h.html">list.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="listeners.h.html">listeners.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailbox.c.html">mailbox.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailbox.h.html">mailbox.h</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">memory.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory.h.html">memory.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="module.c.html">module.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="module.h.html">module.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="nifs.c.html">nifs.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="nifs.h.html">nifs.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="opcodes.h.html">opcodes.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_crypto.c.html">otp_crypto.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_crypto.h.html">otp_crypto.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_net.c.html">otp_net.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_net.h.html">otp_net.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_socket.c.html">otp_socket.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_socket.h.html">otp_socket.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_ssl.c.html">otp_ssl.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="otp_ssl.h.html">otp_ssl.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="overflow_helpers.h.html">overflow_helpers.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="platform_nifs.h.html">platform_nifs.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="port.c.html">port.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="port.h.html">port.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="portnifloader.c.html">portnifloader.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="portnifloader.h.html">portnifloader.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="posix_nifs.c.html">posix_nifs.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="posix_nifs.h.html">posix_nifs.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="refc_binary.c.html">refc_binary.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="refc_binary.h.html">refc_binary.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="resources.c.html">resources.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="resources.h.html">resources.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="scheduler.h.html">scheduler.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="smp.h.html">smp.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="stacktrace.c.html">stacktrace.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="stacktrace.h.html">stacktrace.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="synclist.h.html">synclist.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="sys.h.html">sys.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="sys_mbedtls.h.html">sys_mbedtls.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="term.c.html">term.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="term.h.html">term.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="term_typedef.h.html">term_typedef.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="timer_list.c.html">timer_list.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="timer_list.h.html">timer_list.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="trace.h.html">trace.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="unicode.c.html">unicode.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="unicode.h.html">unicode.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.c.html">utils.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.h.html">utils.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="valueshashtable.c.html">valueshashtable.c</a></li>
<li class="toctree-l4"><a class="reference internal" href="valueshashtable.h.html">valueshashtable.h</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../C_CODING_STYLE.html">AtomVM C Coding Style Guide (AVMCCS Guide)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CHANGELOG.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AtomVM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../api-reference-documentation.html">API Reference Documentation</a></li>
          <li class="breadcrumb-item"><a href="../index.html">libAtomVM</a></li>
      <li class="breadcrumb-item active">memory.c</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="memory-c">
<h1>memory.c<a class="headerlink" href="#memory-c" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<p>Include dependency graph for memory.c:</p>
<figure class="align-default">
<div align="center" class="align-center"><div class="graphviz"><object data="../../../_images/graphviz-efa82316216ba0985694bf9f2131d5f7cc5734fc.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph {
    graph [bgcolor=&quot;#00000000&quot;]
    node [shape=rectangle style=filled fillcolor=&quot;#FFFFFF&quot; font=Helvetica padding=2]
    edge [color=&quot;#1414CE&quot;]
    &quot;9&quot; [label=&quot;atom.h&quot; tooltip=&quot;atom.h&quot;]
    &quot;10&quot; [label=&quot;atom_table.h&quot; tooltip=&quot;atom_table.h&quot;]
    &quot;32&quot; [label=&quot;bitstring.h&quot; tooltip=&quot;bitstring.h&quot;]
    &quot;6&quot; [label=&quot;context.h&quot; tooltip=&quot;context.h&quot;]
    &quot;35&quot; [label=&quot;debug.h&quot; tooltip=&quot;debug.h&quot;]
    &quot;36&quot; [label=&quot;dictionary.h&quot; tooltip=&quot;dictionary.h&quot;]
    &quot;14&quot; [label=&quot;erl_nif.h&quot; tooltip=&quot;erl_nif.h&quot;]
    &quot;37&quot; [label=&quot;erl_nif_priv.h&quot; tooltip=&quot;erl_nif_priv.h&quot;]
    &quot;18&quot; [label=&quot;ets.h&quot; tooltip=&quot;ets.h&quot;]
    &quot;34&quot; [label=&quot;exportedfunction.h&quot; tooltip=&quot;exportedfunction.h&quot;]
    &quot;7&quot; [label=&quot;globalcontext.h&quot; tooltip=&quot;globalcontext.h&quot;]
    &quot;24&quot; [label=&quot;intn.h&quot; tooltip=&quot;intn.h&quot;]
    &quot;31&quot; [label=&quot;jit.h&quot; tooltip=&quot;jit.h&quot;]
    &quot;19&quot; [label=&quot;list.h&quot; tooltip=&quot;list.h&quot;]
    &quot;28&quot; [label=&quot;mailbox.h&quot; tooltip=&quot;mailbox.h&quot;]
    &quot;1&quot; [label=&quot;/__w/AtomVM/AtomVM/src/libAtomVM/memory.c&quot; tooltip=&quot;/__w/AtomVM/AtomVM/src/libAtomVM/memory.c&quot; fillcolor=&quot;#BFBFBF&quot;]
    &quot;25&quot; [label=&quot;memory.h&quot; tooltip=&quot;memory.h&quot;]
    &quot;26&quot; [label=&quot;refc_binary.h&quot; tooltip=&quot;refc_binary.h&quot;]
    &quot;27&quot; [label=&quot;resources.h&quot; tooltip=&quot;resources.h&quot;]
    &quot;21&quot; [label=&quot;smp.h&quot; tooltip=&quot;smp.h&quot;]
    &quot;20&quot; [label=&quot;synclist.h&quot; tooltip=&quot;synclist.h&quot;]
    &quot;22&quot; [label=&quot;term.h&quot; tooltip=&quot;term.h&quot;]
    &quot;15&quot; [label=&quot;term_typedef.h&quot; tooltip=&quot;term_typedef.h&quot;]
    &quot;29&quot; [label=&quot;timer_list.h&quot; tooltip=&quot;timer_list.h&quot;]
    &quot;39&quot; [label=&quot;trace.h&quot; tooltip=&quot;trace.h&quot;]
    &quot;33&quot; [label=&quot;unicode.h&quot; tooltip=&quot;unicode.h&quot;]
    &quot;11&quot; [label=&quot;utils.h&quot; tooltip=&quot;utils.h&quot;]
    &quot;30&quot; [label=&quot;valueshashtable.h&quot; tooltip=&quot;valueshashtable.h&quot;]
    &quot;16&quot; [label=&quot;assert.h&quot; tooltip=&quot;assert.h&quot;]
    &quot;12&quot; [label=&quot;inttypes.h&quot; tooltip=&quot;inttypes.h&quot;]
    &quot;17&quot; [label=&quot;limits.h&quot; tooltip=&quot;limits.h&quot;]
    &quot;2&quot; [label=&quot;stdbool.h&quot; tooltip=&quot;stdbool.h&quot;]
    &quot;13&quot; [label=&quot;stddef.h&quot; tooltip=&quot;stddef.h&quot;]
    &quot;8&quot; [label=&quot;stdint.h&quot; tooltip=&quot;stdint.h&quot;]
    &quot;3&quot; [label=&quot;stdio.h&quot; tooltip=&quot;stdio.h&quot;]
    &quot;4&quot; [label=&quot;stdlib.h&quot; tooltip=&quot;stdlib.h&quot;]
    &quot;5&quot; [label=&quot;string.h&quot; tooltip=&quot;string.h&quot;]
    &quot;23&quot; [label=&quot;sys/types.h&quot; tooltip=&quot;sys/types.h&quot;]
    &quot;38&quot; [label=&quot;tempstack.h&quot; tooltip=&quot;tempstack.h&quot;]
    &quot;9&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;9&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;10&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;10&quot; -&gt; &quot;9&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;10&quot; -&gt; &quot;11&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;32&quot; -&gt; &quot;24&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;32&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;32&quot; -&gt; &quot;33&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;32&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;32&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;7&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;31&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;28&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;21&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;6&quot; -&gt; &quot;29&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;35&quot; -&gt; &quot;6&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;36&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;36&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;14&quot; -&gt; &quot;15&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;37&quot; -&gt; &quot;6&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;37&quot; -&gt; &quot;25&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;37&quot; -&gt; &quot;27&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;18&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;18&quot; -&gt; &quot;20&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;18&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;34&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;9&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;10&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;14&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;18&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;28&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;21&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;20&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;29&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;7&quot; -&gt; &quot;30&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;24&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;24&quot; -&gt; &quot;5&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;24&quot; -&gt; &quot;11&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;31&quot; -&gt; &quot;32&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;31&quot; -&gt; &quot;34&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;31&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;31&quot; -&gt; &quot;15&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;31&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;19&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;28&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;28&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;28&quot; -&gt; &quot;15&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;28&quot; -&gt; &quot;11&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;5&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;6&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;35&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;36&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;37&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;7&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;25&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;26&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;38&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;22&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;39&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;1&quot; -&gt; &quot;11&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;25&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;25&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;25&quot; -&gt; &quot;14&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;25&quot; -&gt; &quot;15&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;25&quot; -&gt; &quot;11&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;26&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;26&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;26&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;26&quot; -&gt; &quot;27&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;27&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;27&quot; -&gt; &quot;14&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;27&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;27&quot; -&gt; &quot;28&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;27&quot; -&gt; &quot;25&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;27&quot; -&gt; &quot;20&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;21&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;20&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;20&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;20&quot; -&gt; &quot;21&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;23&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;5&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;9&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;24&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;25&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;26&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;11&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;22&quot; -&gt; &quot;15&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;15&quot; -&gt; &quot;16&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;15&quot; -&gt; &quot;17&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;15&quot; -&gt; &quot;12&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;15&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;29&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;29&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;29&quot; -&gt; &quot;19&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;33&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;33&quot; -&gt; &quot;13&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;33&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;11&quot; -&gt; &quot;12&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;11&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;11&quot; -&gt; &quot;13&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;11&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;11&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;30&quot; -&gt; &quot;13&quot; [dir=forward tooltip=&quot;include&quot;]
    &quot;30&quot; -&gt; &quot;8&quot; [dir=forward tooltip=&quot;include&quot;]
}</p></object></div>
</div>
</figure>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.MAX">
<span class="target" id="libatomvmmemory_8c_1afa99ec4acc4ecb2dc3c2d05da15d0e3f"></span><span class="sig-name descname"><span class="n"><span class="pre">MAX</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span> <span class="pre">((a)</span> <span class="pre">&gt;</span> <span class="pre">(b)</span> <span class="pre">?</span> <span class="pre">(a)</span> <span class="pre">:</span> <span class="pre">(b))</span><a class="headerlink" href="#c.libAtomVM.memory.c.MAX" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.MEMORY_SHRINK">
<span class="target" id="libatomvmmemory_8c_1a444f159831c06505c73947c8ad8fc674"></span><span class="sig-name descname"><span class="n"><span class="pre">MEMORY_SHRINK</span></span></span> <a class="reference internal" href="#libatomvmmemory_8c_1a59be37b9d1ac6f44b5ba61f22d590ecc"><span class="std std-ref"><span class="pre">memory_gc</span></span></a><a class="headerlink" href="#c.libAtomVM.memory.c.MEMORY_SHRINK" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.FIBONACCI_HEAP_GROWTH_REDUCTION_THRESHOLD">
<span class="target" id="libatomvmmemory_8c_1aacd814b3131a144344125d7094b9dc6d"></span><span class="sig-name descname"><span class="n"><span class="pre">FIBONACCI_HEAP_GROWTH_REDUCTION_THRESHOLD</span></span></span> <span class="pre">10000</span><a class="headerlink" href="#c.libAtomVM.memory.c.FIBONACCI_HEAP_GROWTH_REDUCTION_THRESHOLD" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_scan_and_copy">
<span class="target" id="libatomvmmemory_8c_1a03c809885a032f8271d72ad95bab6a32"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_scan_and_copy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">HeapFragment</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">old_fragment</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mem_start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mem_end</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new_heap_pos</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mso_list</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">move</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_scan_and_copy" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_shallow_copy_term">
<span class="target" id="libatomvmmemory_8c_1aeeda2e3687ebe597032ac29970256fbc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_shallow_copy_term</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">HeapFragment</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">old_fragment</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">t</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new_heap</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">move</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_shallow_copy_term" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_gc">
<span class="target" id="libatomvmmemory_8c_1a59be37b9d1ac6f44b5ba61f22d590ecc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">MemoryGCResult</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_gc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../../../atomvm-internals.html#c.Context" title="Context"><span class="n"><span class="pre">Context</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">new_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">num_roots</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">roots</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_gc" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_init_heap">
<span class="target" id="libatomvmmemory_8c_1aa34223a2c1aa426b283afb1e2461414a"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">MemoryGCResult</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_init_heap</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Heap</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">heap</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_init_heap" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize a root heap. </p>
<p>This function should be balanced with <code class="docutils literal notranslate"><span class="pre">memory_destroy_heap</span></code> or <code class="docutils literal notranslate"><span class="pre">memory_destroy_heap_from_task</span></code> if the heap is created by a driver task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heap</strong> – heap to initialize. </p></li>
<li><p><strong>size</strong> – capacity of the heap to create, not including the mso_list. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MEMORY_GC_OK or MEMORY_GC_ERROR_FAILED_ALLOCATION depending on the outcome. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_init_heap_root_fragment">
<span class="target" id="libatomvmmemory_8c_1aed7cb8e677736e46afa7fe2ef4313658"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_init_heap_root_fragment</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Heap</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">heap</span></span>, <span class="n"><span class="pre">HeapFragment</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">root</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_init_heap_root_fragment" title="Link to this definition"></a><br /></dt>
<dd><p>Setup heap from its root. Set the <code class="docutils literal notranslate"><span class="pre">mso_list</span></code> to NIL and initialize <code class="docutils literal notranslate"><span class="pre">heap_ptr</span></code>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heap</strong> – heap to initialize. </p></li>
<li><p><strong>root</strong> – fragment root. </p></li>
<li><p><strong>size</strong> – capacity of the heap to create, not including the mso_list. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_heap_alloc_new_fragment">
<span class="target" id="libatomvmmemory_8c_1a26b6b3333f2af9aef9a15f175096a126"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">MemoryGCResult</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_heap_alloc_new_fragment</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Heap</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">heap</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_heap_alloc_new_fragment" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_erl_nif_env_ensure_free">
<span class="target" id="libatomvmmemory_8c_1a691d603e669393202b0fa9b99c404437"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">MemoryGCResult</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_erl_nif_env_ensure_free</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">ErlNifEnv</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">env</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_erl_nif_env_ensure_free" title="Link to this definition"></a><br /></dt>
<dd><p>makes sure that the given nif environment has given free memory </p>
<p>this function makes sure that at least size terms are available. When not available, a new fragment will be allocated. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – the target environment. </p></li>
<li><p><strong>size</strong> – needed available memory. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.next_fibonacci_heap_size">
<span class="target" id="libatomvmmemory_8c_1aab09da5159d6524ebfb342d2d4ed9d24"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">next_fibonacci_heap_size</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.next_fibonacci_heap_size" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_ensure_free_with_roots">
<span class="target" id="libatomvmmemory_8c_1a2f22f826b7e8681cad1c4952c9c19629"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">MemoryGCResult</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_ensure_free_with_roots</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../../../atomvm-internals.html#c.Context" title="Context"><span class="n"><span class="pre">Context</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">c</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">num_roots</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">roots</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">MemoryAllocMode</span></span><span class="w"> </span><span class="n"><span class="pre">alloc_mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_ensure_free_with_roots" title="Link to this definition"></a><br /></dt>
<dd><p>makes sure that the given context has given free memory. </p>
<p>this function makes sure at least size terms are available. Optionally, it can allocate a fragment or shrink the heap to the specified size, depending on allocation strategy. The function can also be passed roots to update during any garbage collection. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – the target context. </p></li>
<li><p><strong>size</strong> – needed available memory. </p></li>
<li><p><strong>num_roots</strong> – number of roots </p></li>
<li><p><strong>roots</strong> – roots to preserve </p></li>
<li><p><strong>alloc_mode</strong> – constraint on allocation of additional memory </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.push_to_stack">
<span class="target" id="libatomvmmemory_8c_1af565f43846e4fefd5e70a899703e903c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">push_to_stack</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stack</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.push_to_stack" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_is_moved_marker">
<span class="target" id="libatomvmmemory_8c_1a6b6511dd90d1dbabeb7705625e3cf52a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_is_moved_marker</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_is_moved_marker" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_replace_with_moved_marker">
<span class="target" id="libatomvmmemory_8c_1a64a1155c50c71b4fdcfc7a8dd276fe95"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_replace_with_moved_marker</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">to_be_replaced</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">replace_with</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_replace_with_moved_marker" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_dereference_moved_marker">
<span class="target" id="libatomvmmemory_8c_1ababb6737967fe76146f7da1f1ace4b17"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_dereference_moved_marker</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">moved_marker</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_dereference_moved_marker" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_copy_term_tree_internal">
<span class="target" id="libatomvmmemory_8c_1a0e694c0569a1348f2a0ed197c6bb0b17"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_copy_term_tree_internal</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">heap_ptr</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mso_list</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_copy_term_tree_internal" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_copy_term_tree">
<span class="target" id="libatomvmmemory_8c_1a4f2333ae6f2bceb4fb7c1effde5f648d"></span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_copy_term_tree</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Heap</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new_heap</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_copy_term_tree" title="Link to this definition"></a><br /></dt>
<dd><p>copies a term to a destination heap </p>
<p>deep copies a term to a destination heap, once finished old memory can be freed. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_heap</strong> – the destination heap where terms will be copied. </p></li>
<li><p><strong>t</strong> – term to copy </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new term that is stored on the new heap. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_copy_term_tree_to_storage">
<span class="target" id="libatomvmmemory_8c_1a6c3684abaa77ca5d5b07ba3960622b22"></span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_copy_term_tree_to_storage</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">storage</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">heap_end</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_copy_term_tree_to_storage" title="Link to this definition"></a><br /></dt>
<dd><p>copies a term to a storage, typically for mailbox messages </p>
<p>deep copies a term to a destination heap, once finished old memory can be freed. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage</strong> – storage for the copied data, should be large enough </p></li>
<li><p><strong>heap_end</strong> – on output, pointer to the end of the term. </p></li>
<li><p><strong>t</strong> – term to copy </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a boxed term pointer to the new term content that is stored in the storage. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_estimate_usage">
<span class="target" id="libatomvmmemory_8c_1af2ce659c9162754c8515fbd1b170fc9e"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_estimate_usage</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_estimate_usage" title="Link to this definition"></a><br /></dt>
<dd><p>calculates term memory usage </p>
<p>perform an used memory calculation using given term as root, shared memory (that is not part of the memory block) is not accounted. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – root term on which used memory calculation will be performed. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>used memory terms count in term units output parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_heap_fragment_contains_pointer">
<span class="target" id="libatomvmmemory_8c_1a7900467ef2d1b1e8d842f1bdebfa5950"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_heap_fragment_contains_pointer</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">HeapFragment</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">old_fragment</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_heap_fragment_contains_pointer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_heap_append_fragment">
<span class="target" id="libatomvmmemory_8c_1ac3585e49af06865398260c71ac8dead3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_heap_append_fragment</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Heap</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">heap</span></span>, <span class="n"><span class="pre">HeapFragment</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fragment</span></span>, <span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">mso_list</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_heap_append_fragment" title="Link to this definition"></a><br /></dt>
<dd><p>append a fragment to a heap. The MSO list is merged. The fragment will then be owned by the heap. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heap</strong> – the heap to append the fragment to </p></li>
<li><p><strong>fragment</strong> – the fragment to add </p></li>
<li><p><strong>mso_list</strong> – associated mso list or nil </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.libAtomVM.memory.c.memory_sweep_mso_list">
<span class="target" id="libatomvmmemory_8c_1af565e796d744e507378935dfad5b89f1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">memory_sweep_mso_list</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">term</span></span><span class="w"> </span><span class="n"><span class="pre">mso_list</span></span>, <a class="reference internal" href="../../../atomvm-internals.html#c.GlobalContext" title="GlobalContext"><span class="n"><span class="pre">GlobalContext</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">global</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">from_task</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.libAtomVM.memory.c.memory_sweep_mso_list" title="Link to this definition"></a><br /></dt>
<dd><p>Sweep any unreferenced binaries in the “Mark Sweep Object” (MSO) list. </p>
<p>The MSO list is a list of term (references) in a heap. Currently, the elements of this list are referenced to reference-counted binaries or match binaries that themselves reference reference counted binaries. This function will iterate over the binaries in this list, and decrement the reference count of any elements that have not been marked for move (e.g., into a new heap). If the reference count reaches 0, then memory associated with the referenced binary will be freed.In a typical GC event, the terms in this list are within in the old heap or potentially in a heap fragment. However, this function may be called in a copy even, such as in a process spawn, or in the copy of a term to or from a process mailbox. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mso_list</strong> – the list of mark-sweep object in a heap “space” </p></li>
<li><p><strong>global</strong> – the global context </p></li>
<li><p><strong>from_task</strong> – boolean, true if called from a task, false otherwise </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mailbox.h.html" class="btn btn-neutral float-left" title="mailbox.h" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="memory.h.html" class="btn btn-neutral float-right" title="memory.h" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2024, AtomVM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!--
 Copyright 2023 Winford (Uncle Grumpy) <winford@object.stream>

 SPDX-License-Identifier: Apache-2.0 OR LGPL-2.1-or-later

 Based on the work of  Michael Altfield:
 https://tech.michaelaltfield.net/2020/07/18/sphinx-rtd-github-pages-1
-->



  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-download"></span><span class="fa fa-book"> AtomVM Docs version:</span>
      main branch (unstable)
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt><span class="fa fa-book"> Versions</span></dt>
        
          
          <dd><a href="/v0.5.0/">v0.5.0</a></dd>
          
        
          
          <dd><a href="/v0.6.0/">v0.6.0</a></dd>
          
        
          
          <dd><a href="/v0.6.1/">v0.6.1</a></dd>
          
        
          
          <dd><a href="/v0.6.2/">v0.6.2</a></dd>
          
        
          
          <dd><a href="/v0.6.3/">v0.6.3</a></dd>
          
        
          
          <dd><a href="/v0.6.4/">v0.6.4</a></dd>
          
        
          
          <dd><a href="/v0.6.5/">v0.6.5</a></dd>
          
        
          
          <dd><a href="/v0.6.6/">v0.6.6</a></dd>
          
        
          
          <dd><a href="/release-0.6/">release-0.6 branch (unreleased)</a></dd>
          
        
           <strong> 
          <dd><a href="/main/">main branch (unstable)</a></dd>
           </strong> 
        
      </dl>
      
      
      <dl>
        <dt><span class="fa fa-download"> Downloads</span></dt>
        
          <dd><a href="/main/epub/AtomVM-main.epub">epub</a></dd>
        
      </dl>
      
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>